# 검색 시스템과 엘라스틱서치

## 엘라스틱서치가 강력한 이유

- 오픈소스 검색엔진
    - 아파치 재단의 루씬(Lucene)을 기반으로 개발된 오픈소스 검색엔진
    - 전 세계에서 수많은 사람들이 사용하고 있으며, 버그가 발생할 경우에도 대부분 빠르게 해결된다.
- 전문 검색
    -  전문 검색이란 내용 전체를 색인해서 특정 단어가 포함된 문서를 검색하는 것을 말한다.
    - 엘라스틱서치는 좀 더 고차원적인 전문 검색(Full Text)이 가능하다.
    - 기존 관계형 데이터베이스는 전문 검색에 적합하지 않지만 엘라스틱서치는 다양한 기능별, 언어별 플러그인을 조합해 빠르게 검색할 수 있다.
- 통계분석
    - 비정형 로그 데이터를 수집하고 한곳에 모아 통계 분석을 할 수 있다.
    - 엘라스틱서치와 키바나(Kibana)를 연결하면 실시간으로 쌓이는 로그를 시각화하고 분석할 수 있다.
- 스키마리스(Schemaless)
    - 정형화되지 않은 다양한 형태의 문서도 자동으로 색인하고 검색할 수 있다.
- RESTful API
    - HTTP 기반의 RESTful API를 지원하고 요청뿐 아니라 응답에도 JSON 형식을 사용해 개발 언어, 운영체제, 시스템에 관계없이 이기종 플랫폼에서도 이용 가능하다.
- 멀티테넌시(Multi-tenancy)
    - 서로 상이한 인덱스일지라도 검색할 필드명만 같으면 여러 개의 인덱스를 한번에 조회할 수 있다.
- Document-Oriented
    - 여러 계층의 데이터를 JSON 형식의 구조화된 문서로 인덱스에 저장할 수 있다.
    - 계층 구조로 문서도 한번의 쿼리로 쉽게 조회할 수 있다.
- 역색인(Inverted Index)
    - 역색인이란 종이책의 마지막 페이지에서 제공하는 색인 페이지와 비슷하게 제공되는 특수한 데이터 구조
    - 역색인 구조는 해당 단어만 찾으면 단어가 포함된 모든 문서의 위치를 알 수 있기 때문에 빠르게 찾을 수 있다.
- 확장성과 가용성
    - 엘라스틱서치를 분산 구성해서 확장한다면 대량의 문서를 좀 더 효율적으로 처리할 수 있다.
    - 분산 환경에서는 데이터는 샤드(Shard)라는 작은 단위로 나뉘어 제공되며, 인덱스를 만들 때마다 샤드의 수를 조절할 수 있다. 이를 통해 데이터의 종류와 성격에 따라 데이터를 분산해서 빠르게 처리할 수 있다.

## 엘라시틱서치의 약점
- '실시간'이 아니다.
    - 일반적으로 색인된 데이터는 통상적으로 1초 뒤에나 검색이 가능해진다.
    - 색인된 데이터는 내부적으로 커밋(Commit)과 플러시(Flush) 같은 복잡한 과정을 거치기 때문에 실시간이 아니다. 
    - 엄밀히 따지자면 준 실시간(Near Realtime)이라고 할 수 있다.
- 트랜잭션과 롤백 기능을 제공하지 않는다.
    - 전체적인 클러스터의 성능 향상을 위해 시스템적으로 비용 소모가 큰 롤백(Rollback)과 트랜잭션(Transaction)을 지원하지 않기 때문에 최악의 경우 데이터 손실의 위험이 있다.
- 데이터의 업데이트를 제공하지 않는다.
    - 업데이트 명령이 요청될 경우 기존 문서를 삭제하고 변경된 내용으로 새로운 문서를 생성하는 방식을 사용한다.
    - 이러한 이유로 단순 업데이트에 비해서는 상대적으로 많은 비용이 발생한다.
    - 하지만 이것은 큰 단점이 아니다. 이를 통해 불변적(Immutable)이라는 이점을 취할 수 있다.